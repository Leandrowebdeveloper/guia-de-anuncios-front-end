{"version":3,"file":"default-src_app_pages_dashboard_auth_announcement_pages_enabled-item_enabled-item_module_ts.js","mappings":"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","sources":["./src/app/pages/dashboard/auth/announcement/pages/enabled-item/enabled-item-routing.module.ts","./src/app/pages/dashboard/auth/announcement/pages/enabled-item/enabled-item.module.ts","./src/app/pages/dashboard/auth/announcement/pages/enabled-item/enabled-item.page.ts","./src/app/pages/dashboard/auth/announcement/pages/enabled-item/enabled-item.page.scss"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { EnabledItemAnnouncementPage } from './enabled-item.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EnabledItemAnnouncementPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class EnabledItemAnnouncementPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EnabledItemAnnouncementPage } from './enabled-item.page';\nimport { EnabledItemAnnouncementPageRoutingModule } from './enabled-item-routing.module';\nimport { PipeModule } from 'src/app/pipe/pipe.module';\nimport { AnnouncementComponentsModule } from 'src/app/pages/dashboard/component/announcement/announcement-component.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    EnabledItemAnnouncementPageRoutingModule,\n    AnnouncementComponentsModule,\n    PipeModule,\n  ],\n  declarations: [EnabledItemAnnouncementPage],\n  exports: [EnabledItemAnnouncementPage],\n})\nexport class EnabledItemAnnouncementPageModule {}\n","import { Platform } from '@ionic/angular';\nimport { catchError, tap } from 'rxjs/operators';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { LoadingService } from 'src/app/utilities/loading/loading.service';\nimport { MessageService } from 'src/app/utilities/message/message.service';\nimport { AlertService } from 'src/app//utilities/alert/alert.service';\nimport { AuthAnnouncementService } from 'src/app/pages/dashboard/auth/announcement/service/auth-announcement.service';\nimport { Announcement, User, Category } from 'src/app/interface';\nimport { Observable, Subject, Subscription, EMPTY } from 'rxjs';\nimport { Component, OnInit, Output, EventEmitter, Input } from '@angular/core';\nimport { AuthService } from 'src/app/services/auth/auth.service';\n\n@Component({\n  selector: 'app-enabled-item-announcement-page',\n  templateUrl: './enabled-item.page.html',\n  styleUrls: ['./enabled-item.page.scss', '../../dashboard.page.scss'],\n})\nexport class EnabledItemAnnouncementPage implements OnInit {\n  @Input() user!: Pick<User, 'id' | '_csrf' | 'plan'> | void;\n  @Output() isAnnouncement = new EventEmitter<boolean>(undefined);\n  public announcement$!: Observable<Announcement[]>;\n  public announcement!: Announcement[];\n  public isAdmin!: boolean;\n\n  public isDeleted!: number;\n  public error = new Subject<boolean>();\n  public menssage!: boolean;\n\n  public isDesktop!: boolean;\n\n  private destroyAnnouncement!: Subscription;\n\n  private limit = 12;\n  private offset = 0;\n\n  constructor(\n    private plt: Platform,\n    private authAnnouncementService: AuthAnnouncementService,\n    private authService: AuthService,\n    private alertService: AlertService,\n    public messageService: MessageService,\n    private loadingService: LoadingService\n  ) {}\n\n  ngOnInit() {\n    this.getAnnouncement();\n    this.isPlatform();\n    this.setButtonCreate();\n  }\n\n  public refresher(event: any): void {\n    this.getAnnouncement();\n    event.target.complete();\n  }\n\n  public hideMenssage(): void {\n    this.menssage = true;\n  }\n\n  public actionButton(event: {\n    action: 'destroy' | 'restore' | 'drop';\n    index: number;\n    announcement: Required<Pick<Announcement, '_csrf' | 'id'>>;\n  }): Promise<void> | void {\n    const { action, index, announcement } = event;\n    if (action === 'destroy') {\n      return this.destroy(index, announcement);\n    }\n  }\n\n  public async destroy(\n    index: number,\n    announcement: Required<Pick<Announcement, '_csrf' | 'id'>>\n  ) {\n    this.isDeleted = index;\n    const alert = await this.alertService.alertController.create({\n      header: 'Atenção',\n      message: 'Este anúncio será enviado para a lixeira.',\n      buttons: [\n        {\n          text: 'Cancelar',\n          role: 'cancel',\n          handler: () => {\n            this.isDeleted = -1;\n          },\n        },\n        {\n          text: 'Ok',\n          role: 'confirm',\n          handler: () => this.deleted(announcement, index),\n        },\n      ],\n    });\n\n    await alert.present();\n  }\n\n  private removeItem(index: number) {\n    setTimeout(() => {\n      this.isDeleted = -1;\n      this.announcement.splice(index, 1);\n    }, 6000);\n  }\n\n  private getAnnouncement(): Observable<Announcement[]> | void {\n    if (this.user?.id) {\n      return (this.announcement$ = this.authAnnouncementService\n        .getAnnouncementAll('get', {\n          limit: this.limit,\n          offset: this.offset,\n          userId: this.user?.id,\n        })\n        .pipe(\n          tap((announcement: Announcement[]) => {\n            this.isAnnouncement.emit(announcement.length > 0);\n            this.announcement = announcement.map((announcement_) => {\n              announcement_.category = {\n                ...announcement_?.categoryAnnouncement?.category,\n              } as Category;\n\n              delete announcement_?.announcement;\n              delete announcement_?.categoryAnnouncement?.catAdId;\n              delete announcement_?.categoryAnnouncement?.category;\n              delete announcement_?.categoryAnnouncement?.announcementId;\n              delete announcement_?.categoryAnnouncement?.message;\n\n              return announcement_;\n            });\n          }),\n          catchError((error: HttpErrorResponse) => {\n            setTimeout(() => (this.menssage = false), 300);\n            this.error.next(true);\n            return EMPTY;\n          })\n        ));\n    }\n  }\n\n  private deleted(\n    announcement: Required<Pick<Announcement, '_csrf' | 'id'>>,\n    index: number\n  ) {\n    const loading = this.loadingService.show('Enviando para lixeira...');\n    this.destroyAnnouncement = this.authAnnouncementService\n      .delete(announcement)\n      .subscribe({\n        next: (announcement_: Announcement) =>\n          this.success(index, announcement_, loading),\n        error: (error: HttpErrorResponse) =>\n          this.messageService.error(error, loading, this.destroyAnnouncement),\n      });\n  }\n\n  private success(\n    index: number,\n    announcement_: Announcement,\n    loading: Promise<HTMLIonLoadingElement>\n  ) {\n    this.removeItem(index);\n    this.message(announcement_, loading);\n  }\n\n  private message(\n    announcement_: Announcement,\n    loading: Promise<HTMLIonLoadingElement>\n  ) {\n    if (announcement_?.message) {\n      this.messageService.success(\n        announcement_?.message,\n        loading,\n        this.destroyAnnouncement,\n        2000\n      );\n    }\n  }\n\n  private async isPlatform(): Promise<boolean> {\n    return this.plt\n      .ready()\n      .then(() => (this.isDesktop = this.plt.is('desktop')));\n  }\n\n  private setButtonCreate() {\n    this.isAdmin = this.authService.getLevel === '1';\n  }\n}\n","// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".content-center {\\n  font-size: 1em;\\n}\\n.content-center ion-icon {\\n  font-size: 2.5em;\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/app/pages/dashboard/auth/announcement/pages/enabled-item/enabled-item.page.scss\"],\"names\":[],\"mappings\":\"AAAA;EACE,cAAA;AACF;AAAE;EACE,gBAAA;AAEJ\",\"sourcesContent\":[\".content-center {\\n  font-size: 1em;\\n  ion-icon {\\n    font-size: 2.5em;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___.toString();\n"],"names":["NgModule","RouterModule","EnabledItemAnnouncementPage","routes","path","component","EnabledItemAnnouncementPageRoutingModule","imports","forChild","exports","CommonModule","FormsModule","IonicModule","PipeModule","AnnouncementComponentsModule","EnabledItemAnnouncementPageModule","declarations","Platform","catchError","tap","LoadingService","MessageService","AlertService","AuthAnnouncementService","Subject","EMPTY","Component","Output","EventEmitter","Input","AuthService","constructor","plt","authAnnouncementService","authService","alertService","messageService","loadingService","undefined","ngOnInit","getAnnouncement","isPlatform","setButtonCreate","refresher","event","target","complete","hideMenssage","menssage","actionButton","action","index","announcement","destroy","isDeleted","alert","alertController","create","header","message","buttons","text","role","handler","deleted","present","removeItem","setTimeout","splice","user","id","announcement$","getAnnouncementAll","limit","offset","userId","pipe","isAnnouncement","emit","length","map","announcement_","category","Object","categoryAnnouncement","catAdId","announcementId","error","next","loading","show","destroyAnnouncement","delete","subscribe","success","ready","then","isDesktop","is","isAdmin","getLevel","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}