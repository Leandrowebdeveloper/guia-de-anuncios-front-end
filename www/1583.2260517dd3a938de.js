"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1583],{887:(E,m,n)=>{n.d(m,{B:()=>A});var d=n(655),p=n(2340),_=function l(i,t){if(i===t)return!0;if(i&&t&&"object"==typeof i&&"object"==typeof t){if(i.constructor!==t.constructor)return!1;var o,s,g;if(Array.isArray(i)){if((o=i.length)!=t.length)return!1;for(s=o;0!=s--;)if(!l(i[s],t[s]))return!1;return!0}if(i.constructor===RegExp)return i.source===t.source&&i.flags===t.flags;if(i.valueOf!==Object.prototype.valueOf)return i.valueOf()===t.valueOf();if(i.toString!==Object.prototype.toString)return i.toString()===t.toString();if((o=(g=Object.keys(i)).length)!==Object.keys(t).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(t,g[s]))return!1;for(s=o;0!=s--;){var y=g[s];if(!l(i[y],t[y]))return!1}return!0}return i!=i&&t!=t};const v="__googleMapsScriptId";var a=(()=>{return(l=a||(a={}))[l.INITIALIZED=0]="INITIALIZED",l[l.LOADING=1]="LOADING",l[l.SUCCESS=2]="SUCCESS",l[l.FAILURE=3]="FAILURE",a;var l})();class u{constructor({apiKey:i,authReferrerPolicy:t,channel:o,client:s,id:g=v,language:y,libraries:D=[],mapIds:R,nonce:T,region:w,retries:x=3,url:G="https://maps.googleapis.com/maps/api/js",version:U}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=i,this.authReferrerPolicy=t,this.channel=o,this.client=s,this.id=g||v,this.language=y,this.libraries=D,this.mapIds=R,this.nonce=T,this.region=w,this.retries=x,this.url=G,this.version=U,u.instance){if(!_(this.options,u.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(u.instance.options)}`);return u.instance}u.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?a.FAILURE:this.done?a.SUCCESS:this.loading?a.LOADING:a.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let i=this.url;return i+=`?callback=${this.CALLBACK}`,this.apiKey&&(i+=`&key=${this.apiKey}`),this.channel&&(i+=`&channel=${this.channel}`),this.client&&(i+=`&client=${this.client}`),this.libraries.length>0&&(i+=`&libraries=${this.libraries.join(",")}`),this.language&&(i+=`&language=${this.language}`),this.region&&(i+=`&region=${this.region}`),this.version&&(i+=`&v=${this.version}`),this.mapIds&&(i+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(i+=`&auth_referrer_policy=${this.authReferrerPolicy}`),i}deleteScript(){const i=document.getElementById(this.id);i&&i.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((i,t)=>{this.loadCallback(o=>{o?t(o.error):i(window.google)})})}loadCallback(i){this.callbacks.push(i),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const i=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=i,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(i){if(this.errors.push(i),this.errors.length<=this.retries){const t=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${t} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},t)}else this.onerrorEvent=i,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(i=>{i(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}var e=n(4650),c=n(9267),r=n(5203),h=n(3242),f=n(1395),b=n(6895),P=n(7868);const M=["map"],I=["sidebar"];function C(l,i){if(1&l){const t=e.EpF();e.TgZ(0,"span",6)(1,"ion-button",11),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.traceRoute())}),e._UZ(2,"ion-icon",12),e.qZA(),e.TgZ(3,"ion-title",9),e._uU(4,"Tra\xe7ar uma rota"),e.qZA()()}}function S(l,i){if(1&l){const t=e.EpF();e.TgZ(0,"span",6)(1,"ion-button",13),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.showInfoMap())}),e._UZ(2,"ion-icon",14),e.qZA(),e.TgZ(3,"ion-title",9),e._uU(4,"Informa\xe7\xe3o"),e.qZA()()}}const O=function(l){return{show:l}};let A=(()=>{class l{constructor(t,o,s,g,y){this.plt=t,this.route=o,this.navCtrl=s,this.coordinateAnnouncementService=g,this.alertService=y,this.toggleInfoMap=!1,this.loader=new u({apiKey:p.N.mapsKey,version:"weekly"})}ionViewDidEnter(){this.initializeMap()}ngOnDestroy(){this.$route.unsubscribe()}ngOnInit(){this.setPlatform()}showInfoMap(){this.toggleInfoMap=!this.toggleInfoMap}back(){this.navCtrl.back()}clearWatch(){var t,o,s,g;(null===(t=this.startPosition)||void 0===t?void 0:t.lat)===(null===(o=this.destinationPosition)||void 0===o?void 0:o.lat)&&(null===(s=this.startPosition)||void 0===s?void 0:s.lng)===(null===(g=this.destinationPosition)||void 0===g?void 0:g.lng)&&(navigator.geolocation.clearWatch(this.mapId),setTimeout(()=>this.mapId=null,1e3),this.alertService.alert("Parab\xe9ns","voc\xea alcan\xe7ou o destino"))}traceRoute(){return(0,d.mG)(this,void 0,void 0,function*(){return this.isMobile?yield this.setRoute():yield(yield this.alertService.alertController.create({header:"Observa\xe7\xe3o:",message:"A geolocaliza\xe7\xe3o \xe9 mais precisa para dispositivos com GPS, como smartphones.",buttons:[{text:"Cancelar"},{text:"Confirmar",handler:()=>(0,d.mG)(this,void 0,void 0,function*(){return yield this.setRoute()})}]})).present()})}setRoute(){return(0,d.mG)(this,void 0,void 0,function*(){const t=yield this.getWatchCoordinate();t instanceof GeolocationPosition?(this.buildCoordinate(t),this.loadRoute()):t instanceof GeolocationPositionError?this.coordinateAnnouncementService.showError(t):this.alertService.alert("Ate\xe7\xe3o",t?.message)})}loadRoute(){this.loader.load().then(()=>{this.calculateRoute(),this.clearWatch()})}buildCoordinate(t){var o,s;this.destinationPosition=new google.maps.LatLng(null===(o=t?.coords)||void 0===o?void 0:o.latitude,null===(s=t?.coords)||void 0===s?void 0:s.longitude)}calculateRoute(){this.destinationPosition&&this.startPosition&&this.calculateAndDisplayRoute()}calculateAndDisplayRoute(){this.directionsService.route(this.directionsRequest()).then(t=>this.directionsRenderer.setDirections(t)).catch(t=>this.alertService.alert("Ate\xe7\xe3o","N\xe3o ser\xe1 permitido o acesso ao mapa."))}directionsRequest(){return{origin:this.destinationPosition,destination:this.startPosition,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,drivingOptions:{departureTime:new Date(Date.now()),trafficModel:google.maps.TrafficModel.PESSIMISTIC}}}setPlatform(){this.plt.ready().then(()=>{this.isMobile=this.plt.is("hybrid")||this.plt.is("android")||this.plt.is("ios")})}initializeMap(){this.getParams(),this.loader.load().then(()=>{this.params&&(this.directionsRenderer=new google.maps.DirectionsRenderer,this.directionsService=new google.maps.DirectionsService,this.buildStartCoordinate(),this.buildMap())})}buildMap(){var t;this.map=new google.maps.Map(this.mapRef.nativeElement,{center:this.startPosition,zoom:14,disableDefaultUI:!0}),this.directionsRenderer.setMap(this.map),this.directionsRenderer.setPanel(this.sidebar.nativeElement),new google.maps.Marker({position:this.startPosition,map:this.map,title:null===(t=this.params)||void 0===t?void 0:t.anuncio,animation:google.maps.Animation.DROP})}buildStartCoordinate(){const{latitude:t,longitude:o}=this.params;this.startPosition=new google.maps.LatLng(Number(t),Number(o))}getParams(){return this.$route=this.route.queryParams.subscribe({next:t=>this.params=t})}getWatchCoordinate(){return(0,d.mG)(this,void 0,void 0,function*(){return yield new Promise((t,o)=>{navigator.geolocation?this.mapId=navigator.geolocation.watchPosition(s=>t(s),s=>t(s)):o(new Error("A geolocaliza\xe7\xe3o n\xe3o \xe9 suportada por este navegador."))})})}}return l.\u0275fac=function(t){return new(t||l)(e.Y36(c.t4),e.Y36(r.gz),e.Y36(c.SH),e.Y36(h.h),e.Y36(f.c))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-maps-component"]],viewQuery:function(t,o){if(1&t&&(e.Gf(M,7),e.Gf(I,7)),2&t){let s;e.iGM(s=e.CRH())&&(o.mapRef=s.first),e.iGM(s=e.CRH())&&(o.sidebar=s.first)}},decls:16,vars:5,consts:[["id","map"],["map",""],[1,"sidepanel",3,"ngClass"],["sidebar",""],["color","primary"],[1,"footer"],[1,"ion-text-center"],["title","Pag\xedna inic\xedal.","data-label","Pag\xedna inic\xedal.",3,"click"],["size","large","color","light","slot","icon-only","name","arrow-back"],["size","small"],["class","ion-text-center",4,"ngIf"],["title","Tra\xe7ar uma rota.","data-label","Tra\xe7ar uma rota.",3,"click"],["size","large","slot","icon-only","color","light","name","map"],["title","Informa\xe7\xf5es da rota.","data-label","Informa\xe7\xf5es da rota.",3,"click"],["size","large","slot","icon-only","color","light","name","information"]],template:function(t,o){1&t&&(e._UZ(0,"app-header-component"),e.TgZ(1,"ion-content"),e._UZ(2,"div",0,1)(4,"div",2,3),e.qZA(),e.TgZ(6,"ion-footer")(7,"ion-toolbar",4)(8,"ion-buttons",5)(9,"span",6)(10,"ion-button",7),e.NdJ("click",function(){return o.back()}),e._UZ(11,"ion-icon",8),e.qZA(),e.TgZ(12,"ion-title",9),e._uU(13,"Voltar"),e.qZA()(),e.YNc(14,C,5,0,"span",10),e.YNc(15,S,5,0,"span",10),e.qZA()()()),2&t&&(e.xp6(4),e.Q6J("ngClass",e.VKq(3,O,o.toggleInfoMap)),e.xp6(10),e.Q6J("ngIf",!o.mapId),e.xp6(1),e.Q6J("ngIf",o.mapId))},dependencies:[b.mk,b.O5,c.YG,c.Sm,c.W2,c.fr,c.gu,c.wd,c.sr,P.G],styles:["#map[_ngcontent-%COMP%]{display:inline-block;width:100%;height:100%}.sidepanel[_ngcontent-%COMP%]{max-width:0;position:fixed;z-index:100000;height:100%;top:83px;bottom:83px;right:0;background-color:var(--ion-color-light);box-shadow:-2px -2px 2px #00000080;overflow-x:hidden;transition:.5s;font-size:x-small}.sidepanel.show[_ngcontent-%COMP%]{max-width:350px}","ion-avatar[_ngcontent-%COMP%]{width:26px;height:26px;margin:0 auto}.footer[_ngcontent-%COMP%]{display:flex;justify-content:space-around}ion-title[_ngcontent-%COMP%]{font-size:x-small}ion-button.md.button-avatar[_ngcontent-%COMP%]{--border-radius: 50px;--padding-bottom: 12px;--padding-end: 12px;--padding-start: 12px;--padding-top: 12px;height:48px!important}"]}),l})()},1395:(E,m,n)=>{n.d(m,{c:()=>v});var d=n(655),p=n(4650),_=n(9267);let v=(()=>{class a{constructor(e){this.alertController=e}alert(e,c){return(0,d.mG)(this,void 0,void 0,function*(){const r=yield this.alertController.create({header:e,message:c,buttons:["OK"]});return yield r.present(),r})}}return a.\u0275fac=function(e){return new(e||a)(p.LFG(_.Br))},a.\u0275prov=p.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},6388:(E,m,n)=>{n.d(m,{e:()=>u});var d=n(655),p=n(4650),_=n(9524),v=n(1395),a=n(3131);let u=(()=>{class e{constructor(r,h,f){this.toastService=r,this.alertService=h,this.helpsService=f}success(r,h,f,b=3e3){return(0,d.mG)(this,void 0,void 0,function*(){return this.disableLoadingUnsubscribeVariable(h,f),this.helpsService.delay(()=>(0,d.mG)(this,void 0,void 0,function*(){return yield this.toastService.show(r,"bottom","thumbs-up",2500)}),b)})}alert(r){return this.helpsService.delay(()=>this.alertService.alert("Aten\xe7\xe3o",r?.error),2e3)}disableLoadingUnsubscribeVariable(r,h){return(0,d.mG)(this,void 0,void 0,function*(){r&&h&&(this.helpsService.delay(()=>(0,d.mG)(this,void 0,void 0,function*(){return(yield r).dismiss()}),2e3),h.unsubscribe())})}error(r,h,f){return this.disableLoadingUnsubscribeVariable(h,f).then(),this.alert(r)}disable(r,h){return(0,d.mG)(this,void 0,void 0,function*(){return yield this.disableLoadingUnsubscribeVariable(r,h)})}}return e.\u0275fac=function(r){return new(r||e)(p.LFG(_.k),p.LFG(v.c),p.LFG(a.f))},e.\u0275prov=p.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},9524:(E,m,n)=>{n.d(m,{k:()=>v});var d=n(655),p=n(4650),_=n(9267);let v=(()=>{class a{constructor(e){this.toastController=e}show(e,c,r,h,f="light"){return(0,d.mG)(this,void 0,void 0,function*(){const b=yield this.toastController.create({message:e,icon:r,duration:h,position:c,color:f,buttons:[{side:"end",icon:"add-circle-outline",handler:()=>this.toastController.dismiss()}]});return b.present(),b})}loading(e,c,r){return(0,d.mG)(this,void 0,void 0,function*(){const h=yield this.toastController.create({message:e,position:c,color:"light",icon:r});return h.present(),h})}}return a.\u0275fac=function(e){return new(e||a)(p.LFG(_.yF))},a.\u0275prov=p.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()}}]);