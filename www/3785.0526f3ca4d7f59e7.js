"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3785],{5866:(Y,R,o)=>{o.d(R,{X:()=>y});var b=o(8505),h=o(1135),g=o(3755),m=o(4650),F=o(529),S=o(6578),A=o(6388),t=o(9267);let y=(()=>{class d extends g.O{constructor(r,a,l,v){super(r,a),this.storageService=a,this.messageService=l,this.navCtrl=v,this.announcement=new h.X([]),this.setApi="announcement"}get announcementObservable(){return this.announcement.asObservable()}get getAnnouncement(){return this.announcement.value}set setAnnouncement(r){this.announcement.next(r)}set deleteAnnouncement(r){var a;const l=this.getAnnouncement.findIndex(v=>v?.id===r?.id);this.announcement.value.splice(l,1),this.setAnnouncement=null===(a=this.announcement)||void 0===a?void 0:a.value}set setDataAnnouncement(r){var a;const l=this.getAnnouncement.findIndex(v=>v?.id===r?.id);this.announcement.value[l]=r,this.setAnnouncement=null===(a=this.announcement)||void 0===a?void 0:a.value}set setCsrf(r){this.csrf=r}createAnnouncement(r){return this.create(r).pipe((0,b.b)(a=>{var l;return(null===(l=this.getAnnouncement)||void 0===l?void 0:l.length)>0?(this.getAnnouncement.unshift(a),this.setAnnouncement=this.getAnnouncement):this.setAnnouncement=[a],this.navCtrl.navigateBack(["/painel-de-controle","anuncio",a.slug])}))}delete(r){const{id:a,_csrf:l}=r;return this.destroy({id:a,_csrf:l},"management/")}drop(r){const{id:a,_csrf:l}=r;return this.destroy({id:a,_csrf:l},"management/drop")}toRestore(r){const{id:a,_csrf:l}=r;return this.patch({id:a,_csrf:l},"management/to-restore")}getAnnouncementAll(r,a){return this.index(`management/${r}`,Object.assign({},a))}getAnnouncementFindOne(r){return this.index("management/get",r)}}return d.\u0275fac=function(r){return new(r||d)(m.LFG(F.eN),m.LFG(S.V),m.LFG(A.e),m.LFG(t.SH))},d.\u0275prov=m.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3785:(Y,R,o)=>{o.r(R),o.d(R,{SystemAccessPageModule:()=>se});var b=o(6895),h=o(9267),g=o(5203),m=o(7120),F=o(1069),S=o(262),A=o(515),t=o(4650),y=o(3755),d=o(529),L=o(6578),r=o(3131);let a=(()=>{class s extends y.O{constructor(e,n,i,u){super(e,n),this.http=e,this.storageService=n,this.router=i,this.helpsService=u,this.setApi="recover"}goToLoginPage(){return this.helpsService.delay(()=>this.router.navigate(["/entrar"]),2500)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN),t.LFG(L.V),t.LFG(g.F0),t.LFG(r.f))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var l=o(655),v=o(1228);let P=(()=>{class s extends y.O{constructor(e,n,i){super(e,n),this.http=e,this.storageService=n,this.authService=i,this.setApi="login"}get stayConnected(){return this.$stayConnected}set stayConnected(e){this.$stayConnected=e}storesTokenDatabaseOrSession(e){return this.stayConnected?this.setUserAndTokenInDatabase(e):this.setUserAndTokenInSession(e)}setTokenSession(e){return sessionStorage.setItem("token",e?.token)}setTokenDatabase(e){return(0,l.mG)(this,void 0,void 0,function*(){return yield this.storageService.setAuthUserToken(e)})}setAuthUser(e){return this.authService.setUser=e,this.authService.setUrlApi(),this.authService.setIsLoggedIn=e}setUserAndTokenInSession(e){this.setAuthUser(e),this.setTokenSession(e),this.storageService.setAuthToken=e?.token}setUserAndTokenInDatabase(e){this.setAuthUser(e),this.setTokenDatabase(e),this.storageService.setAuthToken=e?.token}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN),t.LFG(L.V),t.LFG(v.e))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})(),k=(()=>{class s extends y.O{constructor(e,n,i,u){super(e,n),this.http=e,this.storageService=n,this.navCtrl=i,this.helpsService=u,this.setApi="register"}register(e){return this.create(e)}goToLoginPage(){return this.helpsService.delay(()=>this.navCtrl.navigateForward("/entrar"),2500)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN),t.LFG(L.V),t.LFG(h.SH),t.LFG(r.f))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})(),O=(()=>{class s{constructor(e,n,i,u){this.recoverService=e,this.loginService=n,this.registerService=i,this.router=u}resolve(e){switch(this.activeRoute(e)){case"entrar/admin":case"entrar":return this.loginService.requirement().pipe((0,S.K)(()=>(this.router.parseUrl("/404"),A.E)));case"recuperar-senha":return this.recoverService.requirement().pipe((0,S.K)(()=>(this.router.parseUrl("/404"),A.E)));case"cadastrar":return this.registerService.requirement().pipe((0,S.K)(()=>(this.router.parseUrl("/404"),A.E)))}}activeRoute(e){return e.parent.routeConfig.path}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(a),t.LFG(P),t.LFG(k),t.LFG(g.F0))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();const C=[{route:"/entrar",icon:"log-in",label:"Entrar",fill:!1,aria:"Acessar o sistema.",title:"Acessar o sistema."},{route:"/recuperar-senha",icon:"key",label:"Recuperar senha",fill:!1,aria:"Recuperar senha.",title:"Recuperar senha."},{route:"/cadastrar",icon:"create",label:"cadastrar",fill:!1,aria:"Criar conta.",title:"Criar conta."}];var U=o(6388);let D=(()=>{class s{constructor(e,n,i,u,p,f,T){this.http=e,this.messageService=n,this.authService=i,this.helpsService=u,this.loginService=p,this.recoverService=f,this.registerService=T,this.$activeRoute="login"}get activeRoute(){return this.$activeRoute}set activeRoute(e){this.$activeRoute=e}passwordRecover(e){return this.recoverService.create(e)}sendLoginData(e){return this.setStayConnected(e.stayConnected),this.loginService.create(e)}register(e){return this.registerService.register(e)}setStayConnected(e){this.loginService.stayConnected=e}error(e,n,i){return this.messageService.error(e,n,i)}goToUserPage(){return(0,l.mG)(this,void 0,void 0,function*(){switch(this.activeRoute){case"login":return this.authRoute();case"recover":return this.recoverService.goToLoginPage();case"register":return this.registerService.goToLoginPage()}})}isLogin(e){"login"===this.activeRoute&&this.helpsService.delay(()=>this.loginService.storesTokenDatabaseOrSession(e),2500)}authRoute(){return this.helpsService.delay(()=>(0,l.mG)(this,void 0,void 0,function*(){return yield this.authService.unauthenticatedUserAllowLoginRoute()}),2500)}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN),t.LFG(U.e),t.LFG(v.e),t.LFG(r.f),t.LFG(P),t.LFG(a),t.LFG(k))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var z=o(5866),G=o(8039);function Z(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"app-form",8),t.NdJ("submitDataForm",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.onSubmit(i))})("exportForm",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.importForm(i))}),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("inputConfig",e.config)("attrButton",e.attrButton)}}function N(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"app-requisition-limit",9),t.NdJ("desable",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.setDesable(i))}),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("time",e.time)("route",e.activeRoute())}}let x=(()=>{class s{constructor(e,n,i,u,p,f){this.activatedRoute=e,this.systemAccessService=n,this.authAnnouncementService=i,this.helpsService=u,this.messageService=p,this.loadingService=f}ngOnInit(){this.setConfig(),this.setAttrButtonPage(),this.hasDesable(),this.initAttrButton()}activeRoute(){var e,n;return null===(n=null===(e=this.activatedRoute.snapshot.parent)||void 0===e?void 0:e.routeConfig)||void 0===n?void 0:n.path}canDeactivate(){return this.authorizeRoute()?this.authorizeRoute():!this.canAuthorizeTheRoute()||this.canDeactivatedConfirmAlert()}onSubmit(e){switch(this.activeRoute()){case"entrar":return this.login(e);case"recuperar-senha":return this.recover(e);case"cadastrar":return this.register(e)}}importForm(e){return this.form=e}setDesable(e){this.desable=e}getTimeLeftToUnlock(){var e;this.time=null===(e=this.requiriment)||void 0===e?void 0:e.delay}disableCanDeactivate(e){if(e.auth)return this.urlTree=e.auth}formUpdate(){this.helpsService.delay(()=>{this.helpsService.correctFormGroupValueRecalculatingStatusControlsAndErrorMessages(this.form,this.config)},2500)}initAttrButton(){switch(this.activeRoute()){case"entrar":this.attrButton=C[0];break;case"recuperar-senha":this.attrButton=C[1];break;case"cadastrar":this.attrButton=C[2]}}setAttrButtonPage(){this.attrButtonPage=C}authorizeRoute(){return this.urlTree}canAuthorizeTheRoute(){return this.helpsService.isAuthorizeTheRoute(this.form)}canDeactivatedConfirmAlert(){return this.helpsService.messageAuthorizeTheRoute()}login(e){this.setRouter("login");const n=this.loadingService.show("Acessar o sistema...");return this.systemAccess=this.systemAccessService.sendLoginData(e.value).subscribe({next:i=>{this.success(i,n)},error:i=>this.error(i,n)})}register(e){this.setRouter("register");const n=this.loadingService.show("Cadastrando usu\xe1rio...");return this.systemAccess=this.systemAccessService.register(e.value).subscribe({next:i=>this.success(i,n),error:i=>this.error(i,n)})}recover(e){this.setRouter("recover");const n=this.loadingService.show("Recuperando senha...");return this.systemAccess=this.systemAccessService.passwordRecover(e.value).subscribe({next:i=>this.success(i,n),error:i=>this.error(i,n)})}success(e,n){return this.disableCanDeactivate(e),this.formUpdate(),this.systemAccessService.isLogin(e),this.systemAccessService.goToUserPage(),this.messageService.success(e.message,n,this.systemAccess)}error(e,n){return this.requisitionLimit(e),this.systemAccessService.error(e,n,this.systemAccess)}requisitionLimit(e){403===e.status&&this.helpsService.delay(()=>{this.setError(e),this.hasDesable(),this.formUpdate()},2500)}setError(e){this.requiriment=e?.error}setConfig(){this.addConfig(),this.addRequirement()}addRequirement(){var e;this.requiriment=null===(e=this.config)||void 0===e?void 0:e.requisitionLimit}addConfig(){this.config=this.activatedRoute.snapshot.data.systemAccess}hasDesable(){this.getDesable(),this.desable&&this.getTimeLeftToUnlock()}getDesable(){this.requiriment&&this.addDesable()}addDesable(){this.desable=this.isDesabled()}isDesabled(){return this.requiriment.count>=3}setRouter(e){this.systemAccessService.activeRoute=e}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(g.gz),t.Y36(D),t.Y36(z.X),t.Y36(r.f),t.Y36(U.e),t.Y36(G.b))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-system-access"]],decls:12,vars:4,consts:[["fullscreen","true"],["fixed",""],[4,"ngIf","ngIfElse"],["Message",""],[3,"route"],["color","primary"],[1,"ion-text-center"],[3,"csrf"],[3,"inputConfig","attrButton","submitDataForm","exportForm"],[3,"time","route","desable"]],template:function(e,n){if(1&e&&(t._UZ(0,"app-header-component"),t.TgZ(1,"ion-content",0)(2,"ion-grid",1),t.YNc(3,Z,2,2,"div",2),t.YNc(4,N,1,2,"ng-template",null,3,t.W1O),t._UZ(6,"app-buttons-sccess-component",4),t.TgZ(7,"ion-text",5)(8,"p",6),t._uU(9,"Use as rede sociais"),t.qZA()(),t._UZ(10,"app-social-login",7),t.qZA()(),t._UZ(11,"app-footer")),2&e){const i=t.MAs(5);t.xp6(3),t.Q6J("ngIf",!n.desable)("ngIfElse",i),t.xp6(3),t.Q6J("route",n.activeRoute()),t.xp6(4),t.Q6J("csrf",null==n.config?null:n.config._csrf)}},styles:['p[_ngcontent-%COMP%]{margin-top:32px;position:relative}p[_ngcontent-%COMP%]:after{position:absolute;left:15px;bottom:8px;content:"";display:block;width:38%;background-color:var(--ion-color-light);height:2px}p[_ngcontent-%COMP%]:before{position:absolute;right:15px;top:9px;content:"";display:block;width:38%;background-color:var(--ion-color-light);height:2px}@media only screen and (max-width: 990px){p[_ngcontent-%COMP%]:after{width:32%}p[_ngcontent-%COMP%]:before{width:32%}}@media only screen and (max-width: 768px){p[_ngcontent-%COMP%]:after{width:28%}p[_ngcontent-%COMP%]:before{width:28%}}@media only screen and (max-width: 414px){p[_ngcontent-%COMP%]:after{width:24%}p[_ngcontent-%COMP%]:before{width:24%}}@media only screen and (max-width: 360px){p[_ngcontent-%COMP%]:after{width:20%}p[_ngcontent-%COMP%]:before{width:20%}}',"ion-card-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:100%}ion-card-subtitle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:10px;font-size:160%}"]}),s})();const K=[{path:"",component:x,canActivate:[F.$],canLoad:[F.$],canDeactivate:[m.D],resolve:{systemAccess:O}}];let J=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[O],imports:[g.Bz.forChild(K),g.Bz]}),s})();var _=o(1265);function w(s,c){if(1&s&&(t.TgZ(0,"ion-button",1),t._UZ(1,"ion-icon",2),t._uU(2),t.qZA()),2&s){const e=c.$implicit,n=t.oxw();t.Q6J("routerLink",null==e?null:e.route)("title",null==e?null:e.title)("hidden","/"+n.route===(null==e?null:e.route)),t.uIk("aria-label",null==e?null:e.aria),t.xp6(1),t.Q6J("name",null==e?null:e.icon),t.xp6(1),t.hij(" ",null==e?null:e.label,"\n")}}let W=(()=>{class s{constructor(){this.attrButton=C}}return s.\u0275fac=function(e){return new(e||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-buttons-sccess-component"]],inputs:{route:"route"},decls:1,vars:1,consts:[["expand","block","fill","solid","color","primary",3,"routerLink","title","hidden",4,"ngFor","ngForOf"],["expand","block","fill","solid","color","primary",3,"routerLink","title","hidden"],["slot","start",3,"name"]],template:function(e,n){1&e&&t.YNc(0,w,3,6,"ion-button",0),2&e&&t.Q6J("ngForOf",n.attrButton)},dependencies:[b.sg,h.YG,h.gu,h.YI,g.rH]}),s})();var $=o(908),M=o(7423);const j=(0,M.fo)("FacebookLogin",{web:()=>o.e(9884).then(o.bind(o,9884)).then(s=>new s.FacebookLoginWeb)}),I=(0,M.fo)("GoogleAuth",{web:()=>o.e(7733).then(o.bind(o,7733)).then(s=>new s.GoogleAuthWeb)});let E=(()=>{class s extends y.O{constructor(e,n,i){super(e,n),this.http=e,this.storageService=n,this.authService=i,this.setApi="social-login"}get stayConnected(){return this.$stayConnected}set stayConnected(e){this.$stayConnected=e}storesTokenDatabaseOrSession(e){return this.stayConnected?this.setUserAndTokenInDatabase(e):this.setUserAndTokenInSession(e)}setTokenSession(e){return sessionStorage.setItem("token",e?.token)}setTokenDatabase(e){return(0,l.mG)(this,void 0,void 0,function*(){return yield this.storageService.setAuthUserToken(e)})}setAuthUser(e){return this.authService.setUser=e,this.authService.setIsLoggedIn=e}setUserAndTokenInSession(e){this.setAuthUser(e),this.setTokenSession(e),this.storageService.setAuthToken=e?.token}setUserAndTokenInDatabase(e){this.setAuthUser(e),this.setTokenDatabase(e),this.storageService.setAuthToken=e?.token}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN),t.LFG(L.V),t.LFG(v.e))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})(),Q=(()=>{class s{constructor(e,n,i,u,p,f,T){this.systemAccessService=e,this.plt=n,this.http=i,this.socialLoginService=u,this.systemAccessPage=p,this.messageService=f,this.loadingService=T,this.fbLogin=j,this.token=null}ngOnInit(){return(0,l.mG)(this,void 0,void 0,function*(){this.plt.is("desktop")&&(yield this.fbLogin.initialize({appId:"967268348006627"})),this.plt.is("capacitor")||I.initialize()})}facebook(){return(0,l.mG)(this,void 0,void 0,function*(){const n=yield this.fbLogin.login({permissions:["email","user_birthday","user_photos","user_gender"]});n.accessToken&&n.accessToken.userId?(this.token=n.accessToken,this.loadUserData()):n.accessToken&&!n.accessToken.userId&&this.getCurrentToken()})}google(){return(0,l.mG)(this,void 0,void 0,function*(){const e=yield I.signIn();return this.login(e)})}getCurrentToken(){return(0,l.mG)(this,void 0,void 0,function*(){const e=yield this.fbLogin.getCurrentAccessToken();e.accessToken?(this.token=e.accessToken,this.loadUserData()):console.log("Login failed")})}loadUserData(){return(0,l.mG)(this,void 0,void 0,function*(){this.http.get(`https://graph.facebook.com/${this.token.userId}?fields=id,name,picture.width(720),birthday,email&access_token=${this.token.token}`).subscribe({next:n=>this.login(n)})})}login(e){if(e){this.setRouter(),this.systemAccessService.setStayConnected(!0);const n=this.loadingService.show("Acessar o sistema..."),i=Object.assign({},this.build(e));return this.systemAccess=this.socialLoginService.create(i).subscribe({next:u=>this.success(u,n),error:u=>this.error(u,n)})}}success(e,n){return this.systemAccessPage.disableCanDeactivate(e),this.systemAccessService.isLogin(e),this.systemAccessService.goToUserPage(),this.messageService.success(e?.message,n,this.systemAccess)}build(e){var n,i,u;const{id:p,name:f,email:T}=e,B=f.split(" ");return{sid:p,email:T,firstName:B.splice(0,1).join(),lastName:B.join(" "),slug:"",password:"",token:(null===(n=this.token)||void 0===n?void 0:n.token)||JSON.stringify(Object.assign({},e?.authentication)),image:{filename:(null===(u=null===(i=e?.picture)||void 0===i?void 0:i.data)||void 0===u?void 0:u.url)||e?.imageUrl},_csrf:this.csrf}}error(e,n){return this.systemAccessService.error(e,n,this.systemAccess)}setRouter(){this.systemAccessService.activeRoute="login"}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(D),t.Y36(h.t4),t.Y36(d.eN),t.Y36(E),t.Y36(x),t.Y36(U.e),t.Y36(G.b))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-social-login"]],inputs:{csrf:"csrf"},decls:6,vars:0,consts:[["expand","block",1,"ion-margin-top",3,"click"],["slot","icon-only","name","logo-facebook"],["expand","block",3,"click"],["slot","icon-only","name","logo-google"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-button",0),t.NdJ("click",function(){return n.facebook()}),t._UZ(1,"ion-icon",1),t._uU(2," \xa0 facebook\n"),t.qZA(),t.TgZ(3,"ion-button",2),t.NdJ("click",function(){return n.google()}),t._UZ(4,"ion-icon",3),t._uU(5," \xa0 google\n"),t.qZA())},dependencies:[h.YG,h.gu]}),s})();var H=o(677),V=o(6444),X=o(2077),q=o(2209),ee=o(7868),te=o(67);let se=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[D,k,a,P,E,x],imports:[b.ez,h.Pc,J,_.Q,$.o,H.O,V._]}),s})();t.B6R(x,[b.O5,h.W2,h.jY,h.yW,X.U,q.o,ee.G,te.S,W,Q],[])}}]);