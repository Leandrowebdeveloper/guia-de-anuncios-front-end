"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3225],{5866:(M,f,n)=>{n.d(f,{X:()=>g});var S=n(8505),A=n(1135),v=n(3755),l=n(4650),y=n(529),D=n(6578),P=n(6388),t=n(9267);let g=(()=>{class m extends v.O{constructor(i,r,a,d){super(i,r),this.storageService=r,this.messageService=a,this.navCtrl=d,this.announcement=new A.X([]),this.setApi="announcement"}get announcementObservable(){return this.announcement.asObservable()}get getAnnouncement(){return this.announcement.value}set setAnnouncement(i){this.announcement.next(i)}set deleteAnnouncement(i){var r;const a=this.getAnnouncement.findIndex(d=>d?.id===i?.id);this.announcement.value.splice(a,1),this.setAnnouncement=null===(r=this.announcement)||void 0===r?void 0:r.value}set setDataAnnouncement(i){var r;const a=this.getAnnouncement.findIndex(d=>d?.id===i?.id);this.announcement.value[a]=i,this.setAnnouncement=null===(r=this.announcement)||void 0===r?void 0:r.value}set setCsrf(i){this.csrf=i}createAnnouncement(i){return this.create(i).pipe((0,S.b)(r=>{var a;return(null===(a=this.getAnnouncement)||void 0===a?void 0:a.length)>0?(this.getAnnouncement.unshift(r),this.setAnnouncement=this.getAnnouncement):this.setAnnouncement=[r],this.navCtrl.navigateBack(["/painel-de-controle","anuncio",r.slug])}))}delete(i){const{id:r,_csrf:a}=i;return this.destroy({id:r,_csrf:a},"management/")}drop(i){const{id:r,_csrf:a}=i;return this.destroy({id:r,_csrf:a},"management/drop")}toRestore(i){const{id:r,_csrf:a}=i;return this.patch({id:r,_csrf:a},"management/to-restore")}getAnnouncementAll(i,r){return this.index(`management/${i}`,Object.assign({},r))}getAnnouncementFindOne(i){return this.index("management/get",i)}}return m.\u0275fac=function(i){return new(i||m)(l.LFG(y.eN),l.LFG(D.V),l.LFG(P.e),l.LFG(t.SH))},m.\u0275prov=l.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},3225:(M,f,n)=>{n.r(f),n.d(f,{SystemAccessAdminPageModule:()=>N});var S=n(6895),A=n(9267),v=n(5203),l=n(7120),y=n(1069),D=n(262),P=n(515),t=n(4650),g=n(655),m=n(3755),p=n(529),i=n(6578),r=n(1228);let a=(()=>{class s extends m.O{constructor(e,o,c){super(e,o),this.http=e,this.storageService=o,this.authService=c,this.setApi="login-admin"}get stayConnected(){return this.$stayConnected}set stayConnected(e){this.$stayConnected=e}storesTokenDatabaseOrSession(e){return this.stayConnected?this.setUserAndTokenInDatabase(e):this.setUserAndTokenInSession(e)}setTokenSession(e){return sessionStorage.setItem("token",e?.token)}setTokenDatabase(e){return(0,g.mG)(this,void 0,void 0,function*(){return yield this.storageService.setAuthUserToken(e)})}setAuthUser(e){return this.authService.setUser=e,this.authService.setIsLoggedIn=e}setUserAndTokenInSession(e){this.setAuthUser(e),this.setTokenSession(e),this.storageService.setAuthToken=e?.token}setUserAndTokenInDatabase(e){this.setAuthUser(e),this.setTokenDatabase(e),this.storageService.setAuthToken=e?.token}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(p.eN),t.LFG(i.V),t.LFG(r.e))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})(),d=(()=>{class s{constructor(e,o){this.loginAdminService=e,this.router=o}resolve(e){return this.loginAdminService.requirement().pipe((0,D.K)(o=>(this.router.parseUrl("/404"),P.E)))}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(a),t.LFG(v.F0))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var C=n(8039),F=n(6388),E=n(3131);let x=(()=>{class s{constructor(e,o,c,h,T,L){this.http=e,this.loadingService=o,this.messageService=c,this.authService=h,this.helpsService=T,this.loginAdminService=L,this.attrButton={route:"/entrar",icon:"log-in",label:"Entrar",fill:!1,aria:"Acessar o sistema.",title:"Acessar o sistema."}}sendLoginData(e){return this.loginAdminService.stayConnected=e.stayConnected,this.loginAdminService.create(e)}loading(e){return(0,g.mG)(this,void 0,void 0,function*(){return yield this.loadingService.show(e)})}error(e,o,c){return this.messageService.error(e,o,c)}isLogin(e){this.helpsService.delay(()=>this.loginAdminService.storesTokenDatabaseOrSession(e),2500)}goToUserPage(){return(0,g.mG)(this,void 0,void 0,function*(){return this.helpsService.delay(()=>(0,g.mG)(this,void 0,void 0,function*(){return yield this.authService.unauthenticatedUserAllowLoginRoute()}),2500)})}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(p.eN),t.LFG(C.b),t.LFG(F.e),t.LFG(r.e),t.LFG(E.f),t.LFG(a))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var O=n(5866),R=n(2077),U=n(2209),B=n(7868),G=n(67);function I(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"app-form",4),t.NdJ("submitDataForm",function(c){t.CHM(e);const h=t.oxw();return t.KtG(h.onSubmit(c))})("exportForm",function(c){t.CHM(e);const h=t.oxw();return t.KtG(h.importForm(c))}),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("inputConfig",e.config)("attrButton",e.attrButton)}}function z(s,u){if(1&s){const e=t.EpF();t.TgZ(0,"app-requisition-limit",5),t.NdJ("desable",function(c){t.CHM(e);const h=t.oxw();return t.KtG(h.setDesable(c))}),t.qZA()}if(2&s){const e=t.oxw();t.Q6J("time",e.time)("route",e.activeRoute())}}const b=[{path:"",component:(()=>{class s{constructor(e,o,c,h,T,L){this.activatedRoute=e,this.systemAccessService=o,this.helpsService=c,this.authAnnouncementService=h,this.messageService=T,this.loadingService=L}ngOnInit(){this.setConfig(),this.setAttrButtonPage(),this.hasDesable(),this.initAttrButton()}activeRoute(){var e,o;return null===(o=null===(e=this.activatedRoute.snapshot.parent)||void 0===e?void 0:e.routeConfig)||void 0===o?void 0:o.path}canDeactivate(){return this.authorizeRoute()?this.authorizeRoute():!this.canAuthorizeTheRoute()||this.canDeactivatedConfirmAlert()}onSubmit(e){return this.login(e)}importForm(e){return this.form=e}setDesable(e){this.desable=e}getTimeLeftToUnlock(){var e;this.time=null===(e=this.requiriment)||void 0===e?void 0:e.delay}initAttrButton(){this.attrButton=this.systemAccessService.attrButton}setAttrButtonPage(){this.attrButtonPage=this.systemAccessService.attrButton}disableCanDeactivate(e){return this.urlTree=e.auth}authorizeRoute(){return this.urlTree}canAuthorizeTheRoute(){return this.helpsService.isAuthorizeTheRoute(this.form)}canDeactivatedConfirmAlert(){return this.helpsService.messageAuthorizeTheRoute()}login(e){const o=this.loadingService.show("Acessar o sistema...");return this.systemAccess=this.systemAccessService.sendLoginData(e.value).subscribe({next:c=>{this.success(c,o)},error:c=>this.error(c,o)})}success(e,o){return this.disableCanDeactivate(e),this.formUpdate(),this.systemAccessService.isLogin(e),this.systemAccessService.goToUserPage(),this.messageService.success(e?.message,o,this.systemAccess)}error(e,o){return this.requisitionLimit(e),this.systemAccessService.error(e,o,this.systemAccess)}requisitionLimit(e){403===e.status&&this.helpsService.delay(()=>{this.setError(e),this.hasDesable(),this.formUpdate()},2500)}setError(e){this.requiriment=e?.error}formUpdate(){this.helpsService.delay(()=>{this.helpsService.correctFormGroupValueRecalculatingStatusControlsAndErrorMessages(this.form,this.config)},2500)}setConfig(){this.addConfig(),this.addRequirement()}addRequirement(){var e;this.requiriment=null===(e=this.config)||void 0===e?void 0:e.requisitionLimit}addConfig(){this.config=this.activatedRoute.snapshot.data.systemAccess}hasDesable(){this.getDesable(),this.desable&&this.getTimeLeftToUnlock()}getDesable(){this.requiriment&&this.addDesable()}addDesable(){this.desable=this.isDesabled()}isDesabled(){return this.requiriment.count>=3}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(v.gz),t.Y36(x),t.Y36(E.f),t.Y36(O.X),t.Y36(F.e),t.Y36(C.b))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-system-access"]],decls:7,vars:3,consts:[[3,"fullscreen"],["fixed",""],[4,"ngIf","ngIfElse"],["Message",""],[3,"inputConfig","attrButton","submitDataForm","exportForm"],[3,"time","route","desable"]],template:function(e,o){if(1&e&&(t._UZ(0,"app-header-component"),t.TgZ(1,"ion-content",0)(2,"ion-grid",1),t.YNc(3,I,2,2,"div",2),t.YNc(4,z,1,2,"ng-template",null,3,t.W1O),t.qZA()(),t._UZ(6,"app-footer")),2&e){const c=t.MAs(5);t.xp6(1),t.Q6J("fullscreen",!0),t.xp6(2),t.Q6J("ngIf",!o.desable)("ngIfElse",c)}},dependencies:[S.O5,A.W2,A.jY,R.U,U.o,B.G,G.S],styles:["ion-card-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:100%}ion-card-subtitle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:10px;font-size:160%}"]}),s})(),canActivate:[y.$],canDeactivate:[l.D],resolve:{systemAccess:d}}];let Y=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[d],imports:[v.Bz.forChild(b),v.Bz]}),s})();var K=n(1265),W=n(908),J=n(677),Z=n(6444);let N=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[x,a],imports:[S.ez,A.Pc,Y,K.Q,W.o,J.O,Z._]}),s})()}}]);