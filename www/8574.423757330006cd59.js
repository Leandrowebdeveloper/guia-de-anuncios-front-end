"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8574],{8574:(Z,m,n)=>{n.r(m),n.d(m,{SystemAccessAdminPageModule:()=>J});var v=n(6895),l=n(9267),c=n(5203),p=n(7120),S=n(1069),y=n(262),T=n(515),e=n(4650),d=n(655),C=n(3755),D=n(529),L=n(6578),g=n(6388),P=n(1228),A=n(3131);let h=(()=>{class i extends C.O{constructor(t,s,o,r,u){super(t,s),this.http=t,this.storageService=s,this.messageService=o,this.authService=r,this.helpsService=u,this.attrButton={route:"/entrar",icon:"log-in",label:"Entrar",aria:"Acessar o sistema.",title:"Acessar o sistema."},this.setApi="login-admin"}get stayConnected(){return this.$stayConnected}set stayConnected(t){this.$stayConnected=t}storesTokenDatabaseOrSession(t){return this.stayConnected?this.setUserAndTokenInDatabase(t):this.setUserAndTokenInSession(t)}isLogin(t){this.helpsService.delay(()=>this.storesTokenDatabaseOrSession(t),2500)}sendLoginData(t){return this.stayConnected=!!t.stayConnected,this.create(t)}error(t,s,o){return this.messageService.error(t,s,o)}goToUserPage(){return(0,d.mG)(this,void 0,void 0,function*(){return this.helpsService.delay(()=>(0,d.mG)(this,void 0,void 0,function*(){return yield this.authService.unauthenticatedUserAllowLoginRoute()}),2500)})}setTokenSession(t){return sessionStorage.setItem("token",t?.token)}setTokenDatabase(t){return(0,d.mG)(this,void 0,void 0,function*(){return yield this.storageService.setAuthUserToken(t)})}setAuthUser(t){return this.authService.setUser=t,this.authService.setIsLoggedIn=t}setUserAndTokenInSession(t){this.setAuthUser(t),this.setTokenSession(t),this.storageService.setAuthToken=t?.token}setUserAndTokenInDatabase(t){this.setAuthUser(t),this.setTokenDatabase(t),this.storageService.setAuthToken=t?.token}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(D.eN),e.LFG(L.V),e.LFG(g.e),e.LFG(P.e),e.LFG(A.f))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})(),f=(()=>{class i{constructor(t,s){this.loginAdminService=t,this.router=s}resolve(t){return this.loginAdminService.requirement().pipe((0,y.K)(s=>(this.router.parseUrl("/404"),T.E)))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(h),e.LFG(c.F0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var F=n(8039),R=n(1616),x=n(2209),U=n(7868),b=n(8447);function z(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"app-form",4),e.NdJ("submitDataForm",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.onSubmit(o))})("exportForm",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.importForm(o))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("inputConfig",t.config)("attrButton",t.attrButton)}}function B(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"app-requisition-limit",5),e.NdJ("desable",function(o){e.CHM(t);const r=e.oxw();return e.KtG(r.setDesable(o))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("time",t.time)("route",t.route)}}const M=[{path:"",component:(()=>{class i{constructor(t,s,o,r,u){this.activatedRoute=t,this.helpsService=s,this.loginAdminService=o,this.messageService=r,this.loadingService=u}ngOnInit(){this.setConfig(),this.setAttrButtonPage(),this.hasDesable(),this.initAttrButton(),this.activeRoute()}activeRoute(){var t,s,o,r;null!==(s=null===(t=this.activatedRoute.snapshot.parent)||void 0===t?void 0:t.routeConfig)&&void 0!==s&&s.path&&(this.route=null===(r=null===(o=this.activatedRoute.snapshot.parent)||void 0===o?void 0:o.routeConfig)||void 0===r?void 0:r.path)}canDeactivate(){return this.authorizeRoute()?this.authorizeRoute():!this.canAuthorizeTheRoute()||this.canDeactivatedConfirmAlert()}onSubmit(t){return this.login(t)}importForm(t){return this.form=t}setDesable(t){this.desable=t}getTimeLeftToUnlock(){var t;this.time=null===(t=this.requiriment)||void 0===t?void 0:t.delay}initAttrButton(){this.attrButton=this.loginAdminService.attrButton}setAttrButtonPage(){this.attrButtonPage=this.loginAdminService.attrButton}disableCanDeactivate(t){return this.urlTree=t.auth}authorizeRoute(){return this.urlTree}canAuthorizeTheRoute(){return this.helpsService.isAuthorizeTheRoute(this.form)}canDeactivatedConfirmAlert(){return this.helpsService.messageAuthorizeTheRoute()}login(t){const s=this.loadingService.show("Acessar o sistema...");return this.systemAccess=this.loginAdminService.sendLoginData(t.value).subscribe({next:o=>{this.success(o,s)},error:o=>this.error(o,s)})}success(t,s){return this.disableCanDeactivate(t),this.formUpdate(),this.loginAdminService.isLogin(t),this.loginAdminService.goToUserPage(),this.messageService.success(t?.message,s,this.systemAccess)}error(t,s){return this.requisitionLimit(t),this.loginAdminService.error(t,s,this.systemAccess)}requisitionLimit(t){403===t.status&&this.helpsService.delay(()=>{this.setError(t),this.hasDesable(),this.formUpdate()},2500)}setError(t){this.requiriment=t?.error}formUpdate(){this.helpsService.delay(()=>{this.helpsService.correctFormGroupValueRecalculatingStatusControlsAndErrorMessages(this.form,this.config)},2500)}setConfig(){this.addConfig(),this.addRequirement()}addRequirement(){var t;this.requiriment=null===(t=this.config)||void 0===t?void 0:t.requisitionLimit}addConfig(){var t,s,o;this.config=null===(o=null===(s=null===(t=this.activatedRoute)||void 0===t?void 0:t.snapshot)||void 0===s?void 0:s.data)||void 0===o?void 0:o.systemAccess}hasDesable(){this.getDesable(),this.desable&&this.getTimeLeftToUnlock()}getDesable(){this.requiriment&&this.addDesable()}addDesable(){this.desable=this.isDesabled()}isDesabled(){return this.requiriment.count>=3}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.gz),e.Y36(A.f),e.Y36(h),e.Y36(g.e),e.Y36(F.b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-access"]],decls:7,vars:3,consts:[[3,"fullscreen"],["fixed",""],[4,"ngIf","ngIfElse"],["Message",""],[3,"inputConfig","attrButton","submitDataForm","exportForm"],[3,"time","route","desable"]],template:function(t,s){if(1&t&&(e._UZ(0,"app-header-component"),e.TgZ(1,"ion-content",0)(2,"ion-grid",1),e.YNc(3,z,2,2,"div",2),e.YNc(4,B,1,2,"ng-template",null,3,e.W1O),e.qZA()(),e._UZ(6,"app-footer")),2&t){const o=e.MAs(5);e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(2),e.Q6J("ngIf",!s.desable)("ngIfElse",o)}},dependencies:[v.O5,l.W2,l.jY,R.U,x.o,U.G,b.S],styles:["ion-card-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:100%}ion-card-subtitle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:10px;font-size:160%}"]}),i})(),canActivate:[S.$],canDeactivate:[p.D],resolve:{systemAccess:f}}];let G=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[f],imports:[c.Bz.forChild(M),c.Bz]}),i})();var I=n(1265),E=n(908),O=n(677),Y=n(6444);let J=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[h],imports:[v.ez,l.Pc,G,I.Q,E.o,O.O,Y._]}),i})()}}]);